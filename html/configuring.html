<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Basic Configuration &mdash; Glance 2015.1.1.dev9 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2015.1.1.dev9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Glance 2015.1.1.dev9 documentation" href="index.html" />
    <link rel="next" title="Authentication With Keystone" href="authentication.html" />
    <link rel="prev" title="Installation" href="installing.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="basic-configuration">
<h1>Basic Configuration<a class="headerlink" href="#basic-configuration" title="Permalink to this headline">¶</a></h1>
<p>Glance has a number of options that you can use to configure the Glance API
server, the Glance Registry server, and the various storage backends that
Glance can use to store images.</p>
<p>Most configuration is done via configuration files, with the Glance API
server and Glance Registry server using separate configuration files.</p>
<p>When starting up a Glance server, you can specify the configuration file to
use (see <a class="reference internal" href="controllingservers.html"><em>the documentation on controller Glance servers</em></a>).
If you do <strong>not</strong> specify a configuration file, Glance will look in the following
directories for a configuration file, in order:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">~/.glance</span></code></li>
<li><code class="docutils literal"><span class="pre">~/</span></code></li>
<li><code class="docutils literal"><span class="pre">/etc/glance</span></code></li>
<li><code class="docutils literal"><span class="pre">/etc</span></code></li>
</ul>
<p>The Glance API server configuration file should be named <code class="docutils literal"><span class="pre">glance-api.conf</span></code>.
Similarly, the Glance Registry server configuration file should be named
<code class="docutils literal"><span class="pre">glance-registry.conf</span></code>. If you installed Glance via your operating system&#8217;s
package management system, it is likely that you will have sample
configuration files installed in <code class="docutils literal"><span class="pre">/etc/glance</span></code>.</p>
<p>In addition to this documentation page, you can check the
<code class="docutils literal"><span class="pre">etc/glance-api.conf</span></code> and <code class="docutils literal"><span class="pre">etc/glance-registry.conf</span></code> sample configuration
files distributed with Glance for example configuration files for each server
application with detailed comments on what each options does.</p>
<p>The PasteDeploy configuration (controlling the deployment of the WSGI
application for each component) may be found by default in
&lt;component&gt;-paste.ini alongside the main configuration file, &lt;component&gt;.conf.
For example, <code class="docutils literal"><span class="pre">glance-api-paste.ini</span></code> corresponds to <code class="docutils literal"><span class="pre">glance-api.conf</span></code>.
This pathname for the paste config is configurable, as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>[paste_deploy]
config_file = /path/to/paste/config
</pre></div>
</div>
<div class="section" id="common-configuration-options-in-glance">
<h2>Common Configuration Options in Glance<a class="headerlink" href="#common-configuration-options-in-glance" title="Permalink to this headline">¶</a></h2>
<p>Glance has a few command-line options that are common to all Glance programs:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--verbose</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">False</span></code></p>
<p>Can be specified on the command line and in configuration files.</p>
<p>Turns on the INFO level in logging and prints more verbose command-line
interface printouts.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--debug</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">False</span></code></p>
<p>Can be specified on the command line and in configuration files.</p>
<p>Turns on the DEBUG level in logging.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--config-file=PATH</span></code></li>
</ul>
<p>Optional. Default: See below for default search order.</p>
<p>Specified on the command line only.</p>
<p>Takes a path to a configuration file to use when running the program. If this
CLI option is not specified, then we check to see if the first argument is a
file. If it is, then we try to use that as the configuration file. If there is
no file or there were no arguments, we search for a configuration file in the
following order:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">~/.glance</span></code></li>
<li><code class="docutils literal"><span class="pre">~/</span></code></li>
<li><code class="docutils literal"><span class="pre">/etc/glance</span></code></li>
<li><code class="docutils literal"><span class="pre">/etc</span></code></li>
</ul>
<p>The filename that is searched for depends on the server application name. So,
if you are starting up the API server, <code class="docutils literal"><span class="pre">glance-api.conf</span></code> is searched for,
otherwise <code class="docutils literal"><span class="pre">glance-registry.conf</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--config-dir=DIR</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">None</span></code></p>
<p>Specified on the command line only.</p>
<p>Takes a path to a configuration directory from which all *.conf fragments
are loaded. This provides an alternative to multiple &#8211;config-file options
when it is inconvenient to explicitly enumerate all the config files, for
example when an unknown number of config fragments are being generated
by a deployment framework.</p>
<p>If &#8211;config-dir is set, then &#8211;config-file is ignored.</p>
<p>An example usage would be:</p>
<blockquote>
<div><p>$ glance-api &#8211;config-dir=/etc/glance/glance-api.d</p>
<dl class="docutils">
<dt>$ ls /etc/glance/glance-api.d</dt>
<dd>00-core.conf
01-s3.conf
02-swift.conf
03-ssl.conf
... etc.</dd>
</dl>
</div></blockquote>
<p>The numeric prefixes in the example above are only necessary if a specific
parse ordering is required (i.e. if an individual config option set in an
earlier fragment is overridden in a later fragment).</p>
<p>Note that <code class="docutils literal"><span class="pre">glance-manage</span></code> currently loads configuration from three files:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">glance-registry.conf</span></code></li>
<li><code class="docutils literal"><span class="pre">glance-api.conf</span></code></li>
<li>and the newly created <code class="docutils literal"><span class="pre">glance-manage.conf</span></code></li>
</ul>
<p>By default <code class="docutils literal"><span class="pre">glance-manage.conf</span></code> only specifies a custom logging file but
other configuration options for <code class="docutils literal"><span class="pre">glance-manage</span></code> should be migrated in there.
<strong>Warning</strong>: Options set in <code class="docutils literal"><span class="pre">glance-manage.conf</span></code> will override options of
the same section and name set in the other two. Similarly, options in
<code class="docutils literal"><span class="pre">glance-api.conf</span></code> will override options set in <code class="docutils literal"><span class="pre">glance-registry.conf</span></code>.
This tool is planning to stop loading <code class="docutils literal"><span class="pre">glance-registry.conf</span></code> and
<code class="docutils literal"><span class="pre">glance-api.conf</span></code> in a future cycle.</p>
</div>
<div class="section" id="configuring-server-startup-options">
<h2>Configuring Server Startup Options<a class="headerlink" href="#configuring-server-startup-options" title="Permalink to this headline">¶</a></h2>
<p>You can put the following options in the <code class="docutils literal"><span class="pre">glance-api.conf</span></code> and
<code class="docutils literal"><span class="pre">glance-registry.conf</span></code> files, under the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> section. They enable
startup and binding behaviour for the API and registry servers, respectively.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">bind_host=ADDRESS</span></code></li>
</ul>
<p>The address of the host to bind to.</p>
<p>Optional. Default: <code class="docutils literal"><span class="pre">0.0.0.0</span></code></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">bind_port=PORT</span></code></li>
</ul>
<p>The port the server should bind to.</p>
<p>Optional. Default: <code class="docutils literal"><span class="pre">9191</span></code> for the registry server, <code class="docutils literal"><span class="pre">9292</span></code> for the API server</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">backlog=REQUESTS</span></code></li>
</ul>
<p>Number of backlog requests to configure the socket with.</p>
<p>Optional. Default: <code class="docutils literal"><span class="pre">4096</span></code></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tcp_keepidle=SECONDS</span></code></li>
</ul>
<p>Sets the value of TCP_KEEPIDLE in seconds for each server socket.
Not supported on OS X.</p>
<p>Optional. Default: <code class="docutils literal"><span class="pre">600</span></code></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">workers=PROCESSES</span></code></li>
</ul>
<p>Number of Glance API or Registry worker processes to start. Each worker
process will listen on the same port. Increasing this value may increase
performance (especially if using SSL with compression enabled). Typically
it is recommended to have one worker process per CPU. The value <cite>0</cite>
will prevent any new processes from being created.</p>
<p>Optional. Default: The number of CPUs available will be used by default.</p>
<div class="section" id="configuring-ssl-support">
<h3>Configuring SSL Support<a class="headerlink" href="#configuring-ssl-support" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cert_file=PATH</span></code></li>
</ul>
<p>Path to the certificate file the server should use when binding to an
SSL-wrapped socket.</p>
<p>Optional. Default: not enabled.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">key_file=PATH</span></code></li>
</ul>
<p>Path to the private key file the server should use when binding to an
SSL-wrapped socket.</p>
<p>Optional. Default: not enabled.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ca_file=PATH</span></code></li>
</ul>
<p>Path to the CA certificate file the server should use to validate client
certificates provided during an SSL handshake. This is ignored if
<code class="docutils literal"><span class="pre">cert_file</span></code> and &#8216;&#8217;key_file`` are not set.</p>
<p>Optional. Default: not enabled.</p>
</div>
<div class="section" id="configuring-registry-access">
<h3>Configuring Registry Access<a class="headerlink" href="#configuring-registry-access" title="Permalink to this headline">¶</a></h3>
<p>There are a number of configuration options in Glance that control how
the API server accesses the registry server.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">registry_client_protocol=PROTOCOL</span></code></li>
</ul>
<p>If you run a secure Registry server, you need to set this value to <code class="docutils literal"><span class="pre">https</span></code>
and also set <code class="docutils literal"><span class="pre">registry_client_key_file</span></code> and optionally
<code class="docutils literal"><span class="pre">registry_client_cert_file</span></code>.</p>
<p>Optional. Default: http</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">registry_client_key_file=PATH</span></code></li>
</ul>
<p>The path to the key file to use in SSL connections to the
registry server, if any. Alternately, you may set the
<code class="docutils literal"><span class="pre">GLANCE_CLIENT_KEY_FILE</span></code> environ variable to a filepath of the key file</p>
<p>Optional. Default: Not set.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">registry_client_cert_file=PATH</span></code></li>
</ul>
<p>Optional. Default: Not set.</p>
<p>The path to the cert file to use in SSL connections to the
registry server, if any. Alternately, you may set the
<code class="docutils literal"><span class="pre">GLANCE_CLIENT_CERT_FILE</span></code> environ variable to a filepath of the cert file</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">registry_client_ca_file=PATH</span></code></li>
</ul>
<p>Optional. Default: Not set.</p>
<p>The path to a Certifying Authority&#8217;s cert file to use in SSL connections to the
registry server, if any. Alternately, you may set the
<code class="docutils literal"><span class="pre">GLANCE_CLIENT_CA_FILE</span></code> environ variable to a filepath of the CA cert file</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">registry_client_insecure=False</span></code></li>
</ul>
<p>Optional. Default: False.</p>
<p>When using SSL in connections to the registry server, do not require
validation via a certifying authority. This is the registry&#8217;s equivalent of
specifying &#8211;insecure on the command line using glanceclient for the API</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">registry_client_timeout=SECONDS</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">600</span></code>.</p>
<p>The period of time, in seconds, that the API server will wait for a registry
request to complete. A value of &#8216;0&#8217; implies no timeout.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">use_user_token=True</span></code></li>
</ul>
<p>Optional. Default: True</p>
<p>Pass the user token through for API requests to the registry.</p>
<p>If &#8216;use_user_token&#8217; is not in effect then admin credentials can be
specified (see below). If admin credentials are specified then they are
used to generate a token; this token rather than the original user&#8217;s
token is used for requests to the registry.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">admin_user=USER</span></code></li>
</ul>
<p>If &#8216;use_user_token&#8217; is not in effect then admin credentials can be
specified. Use this parameter to specify the username.</p>
<p>Optional. Default: None</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">admin_password=PASSWORD</span></code></li>
</ul>
<p>If &#8216;use_user_token&#8217; is not in effect then admin credentials can be
specified. Use this parameter to specify the password.</p>
<p>Optional. Default: None</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">admin_tenant_name=TENANTNAME</span></code></li>
</ul>
<p>If &#8216;use_user_token&#8217; is not in effect then admin credentials can be
specified. Use this parameter to specify the tenant name.</p>
<p>Optional. Default: None</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">auth_url=URL</span></code></li>
</ul>
<p>If &#8216;use_user_token&#8217; is not in effect then admin credentials can be
specified. Use this parameter to specify the Keystone endpoint.</p>
<p>Optional. Default: None</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">auth_strategy=STRATEGY</span></code></li>
</ul>
<p>If &#8216;use_user_token&#8217; is not in effect then admin credentials can be
specified. Use this parameter to specify the auth strategy.</p>
<p>Optional. Default: keystone</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">auth_region=REGION</span></code></li>
</ul>
<p>If &#8216;use_user_token&#8217; is not in effect then admin credentials can be
specified. Use this parameter to specify the region.</p>
<p>Optional. Default: None</p>
</div>
</div>
<div class="section" id="configuring-logging-in-glance">
<h2>Configuring Logging in Glance<a class="headerlink" href="#configuring-logging-in-glance" title="Permalink to this headline">¶</a></h2>
<p>There are a number of configuration options in Glance that control how Glance
servers log messages.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">--log-config=PATH</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">None</span></code></p>
<p>Specified on the command line only.</p>
<p>Takes a path to a configuration file to use for configuring logging.</p>
<div class="section" id="logging-options-available-only-in-configuration-files">
<h3>Logging Options Available Only in Configuration Files<a class="headerlink" href="#logging-options-available-only-in-configuration-files" title="Permalink to this headline">¶</a></h3>
<p>You will want to place the different logging options in the <strong>[DEFAULT]</strong> section
in your application configuration file. As an example, you might do the following
for the API server, in a configuration file called <code class="docutils literal"><span class="pre">etc/glance-api.conf</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>[DEFAULT]
log_file = /var/log/glance/api.log
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">log_file</span></code></li>
</ul>
<p>The filepath of the file to use for logging messages from Glance&#8217;s servers. If
missing, the default is to output messages to <code class="docutils literal"><span class="pre">stdout</span></code>, so if you are running
Glance servers in a daemon mode (using <code class="docutils literal"><span class="pre">glance-control</span></code>) you should make
sure that the <code class="docutils literal"><span class="pre">log_file</span></code> option is set appropriately.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">log_dir</span></code></li>
</ul>
<p>The filepath of the directory to use for log files. If not specified (the default)
the <code class="docutils literal"><span class="pre">log_file</span></code> is used as an absolute filepath.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">log_date_format</span></code></li>
</ul>
<p>The format string for timestamps in the log output.</p>
<p>Defaults to <code class="docutils literal"><span class="pre">%Y-%m-%d</span> <span class="pre">%H:%M:%S</span></code>. See the
<a class="reference external" href="http://docs.python.org/library/logging.html">logging module</a> documentation for
more information on setting this format string.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">log_use_syslog</span></code></li>
</ul>
<p>Use syslog logging functionality.</p>
<p>Defaults to False.</p>
</div>
</div>
<div class="section" id="configuring-glance-storage-backends">
<h2>Configuring Glance Storage Backends<a class="headerlink" href="#configuring-glance-storage-backends" title="Permalink to this headline">¶</a></h2>
<p>There are a number of configuration options in Glance that control how Glance
stores disk images. These configuration options are specified in the
<code class="docutils literal"><span class="pre">glance-api.conf</span></code> config file in the section <code class="docutils literal"><span class="pre">[glance_store]</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">default_store=STORE</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">file</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>Sets the storage backend to use by default when storing images in Glance.
Available options for this option are (<code class="docutils literal"><span class="pre">file</span></code>, <code class="docutils literal"><span class="pre">swift</span></code>, <code class="docutils literal"><span class="pre">s3</span></code>, <code class="docutils literal"><span class="pre">rbd</span></code>, <code class="docutils literal"><span class="pre">sheepdog</span></code>,
<code class="docutils literal"><span class="pre">cinder</span></code> or <code class="docutils literal"><span class="pre">vsphere</span></code>). In order to select a default store it must also
be listed in the <code class="docutils literal"><span class="pre">stores</span></code> list described below.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">stores=STORES</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">glance.store.filesystem.Store,</span> <span class="pre">glance.store.http.Store</span></code></p>
<p>A comma separated list of enabled glance stores. Options are specified
in the format of glance.store.OPTION.Store.  Some available options for this
option are (<code class="docutils literal"><span class="pre">filesystem</span></code>, <code class="docutils literal"><span class="pre">http</span></code>, <code class="docutils literal"><span class="pre">rbd</span></code>, <code class="docutils literal"><span class="pre">s3</span></code>, <code class="docutils literal"><span class="pre">swift</span></code>, <code class="docutils literal"><span class="pre">sheepdog</span></code>,
<code class="docutils literal"><span class="pre">cinder</span></code>, <code class="docutils literal"><span class="pre">gridfs</span></code>, <code class="docutils literal"><span class="pre">vmware_datastore</span></code>)</p>
</div>
<div class="section" id="configuring-glance-image-size-limit">
<h2>Configuring Glance Image Size Limit<a class="headerlink" href="#configuring-glance-image-size-limit" title="Permalink to this headline">¶</a></h2>
<p>The following configuration option is specified in the
<code class="docutils literal"><span class="pre">glance-api.conf</span></code> config file in the section <code class="docutils literal"><span class="pre">[DEFAULT]</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">image_size_cap=SIZE</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">1099511627776</span></code> (1 TB)</p>
<p>Maximum image size, in bytes, which can be uploaded through the Glance API server.</p>
<p><strong>IMPORTANT NOTE</strong>: this value should only be increased after careful consideration
and must be set to a value under 8 EB (9223372036854775808).</p>
</div>
<div class="section" id="configuring-glance-user-storage-quota">
<h2>Configuring Glance User Storage Quota<a class="headerlink" href="#configuring-glance-user-storage-quota" title="Permalink to this headline">¶</a></h2>
<p>The following configuration option is specified in the
<code class="docutils literal"><span class="pre">glance-api.conf</span></code> config file in the section <code class="docutils literal"><span class="pre">[DEFAULT]</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">user_storage_quota</span></code></li>
</ul>
<p>Optional. Default: 0 (Unlimited).</p>
<p>This value specifies the maximum amount of storage that each user can use
across all storage systems. Optionally unit can be specified for the value.
Values are accepted in B, KB, MB, GB or TB which are for Bytes, KiloBytes,
MegaBytes, GigaBytes and TeraBytes respectively. Default unit is Bytes.</p>
<dl class="docutils">
<dt>Example values would be,</dt>
<dd>user_storage_quota=20GB</dd>
</dl>
<div class="section" id="configuring-the-filesystem-storage-backend">
<h3>Configuring the Filesystem Storage Backend<a class="headerlink" href="#configuring-the-filesystem-storage-backend" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">filesystem_store_datadir=PATH</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">/var/lib/glance/images/</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the filesystem storage backend.</cite></p>
<p>Sets the path where the filesystem storage backend write disk images. Note that
the filesystem storage backend will attempt to create this directory if it does
not exist. Ensure that the user that <code class="docutils literal"><span class="pre">glance-api</span></code> runs under has write
permissions to this directory.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">filesystem_store_file_perm=PERM_MODE</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">0</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the filesystem storage backend.</cite></p>
<p>The required permission value, in octal representation, for the created image file.
You can use this value to specify the user of the consuming service (such as Nova) as
the only member of the group that owns the created files. To keep the default value,
assign a permission value that is less than or equal to 0.  Note that the file owner
must maintain read permission; if this value removes that permission an error message
will be logged and the BadStoreConfiguration exception will be raised.  If the Glance
service has insufficient privileges to change file access permissions, a file will still
be saved, but a warning message will appear in the Glance log.</p>
</div>
<div class="section" id="configuring-the-filesystem-storage-backend-with-multiple-stores">
<h3>Configuring the Filesystem Storage Backend with multiple stores<a class="headerlink" href="#configuring-the-filesystem-storage-backend-with-multiple-stores" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">filesystem_store_datadirs=PATH:PRIORITY</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">/var/lib/glance/images/:1</span></code></p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre>filesystem_store_datadirs = /var/glance/store
filesystem_store_datadirs = /var/glance/store1:100
filesystem_store_datadirs = /var/glance/store2:200
</pre></div>
</div>
<p>This option can only be specified in configuration file and is specific
to the filesystem storage backend only.</p>
<p>filesystem_store_datadirs option allows administrators to configure
multiple store directories to save glance image in filesystem storage backend.
Each directory can be coupled with its priority.</p>
<p><strong>NOTE</strong>:</p>
<ul class="simple">
<li>This option can be specified multiple times to specify multiple stores.</li>
<li>Either filesystem_store_datadir or filesystem_store_datadirs option must be
specified in glance-api.conf</li>
<li>Store with priority 200 has precedence over store with priority 100.</li>
<li>If no priority is specified, default priority &#8216;0&#8217; is associated with it.</li>
<li>If two filesystem stores have same priority store with maximum free space
will be chosen to store the image.</li>
<li>If same store is specified multiple times then BadStoreConfiguration
exception will be raised.</li>
</ul>
</div>
<div class="section" id="configuring-the-swift-storage-backend">
<h3>Configuring the Swift Storage Backend<a class="headerlink" href="#configuring-the-swift-storage-backend" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_auth_address=URL</span></code></li>
</ul>
<p>Required when using the Swift storage backend.</p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>Sets the authentication URL supplied to Swift when making calls to its storage
system. For more information about the Swift authentication system, please
see the <a class="reference external" href="http://swift.openstack.org/overview_auth.html">Swift auth</a>
documentation and the
<a class="reference external" href="http://docs.openstack.org/openstack-object-storage/admin/content/ch02s02.html">overview of Swift authentication</a>.</p>
<p><strong>IMPORTANT NOTE</strong>: Swift authentication addresses use HTTPS by default. This
means that if you are running Swift with authentication over HTTP, you need
to set your <code class="docutils literal"><span class="pre">swift_store_auth_address</span></code> to the full URL, including the <code class="docutils literal"><span class="pre">http://</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_user=USER</span></code></li>
</ul>
<p>Required when using the Swift storage backend.</p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>Sets the user to authenticate against the <code class="docutils literal"><span class="pre">swift_store_auth_address</span></code> with.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_key=KEY</span></code></li>
</ul>
<p>Required when using the Swift storage backend.</p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>Sets the authentication key to authenticate against the
<code class="docutils literal"><span class="pre">swift_store_auth_address</span></code> with for the user <code class="docutils literal"><span class="pre">swift_store_user</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_container=CONTAINER</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">glance</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>Sets the name of the container to use for Glance images in Swift.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_create_container_on_put</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">False</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>If true, Glance will attempt to create the container <code class="docutils literal"><span class="pre">swift_store_container</span></code>
if it does not exist.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_large_object_size=SIZE_IN_MB</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">5120</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>What size, in MB, should Glance start chunking image files
and do a large object manifest in Swift? By default, this is
the maximum object size in Swift, which is 5GB</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_large_object_chunk_size=SIZE_IN_MB</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">200</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>When doing a large object manifest, what size, in MB, should
Glance write chunks to Swift?  The default is 200MB.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_multi_tenant=False</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">False</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>If set to True enables multi-tenant storage mode which causes Glance images
to be stored in tenant specific Swift accounts. When set to False Glance
stores all images in a single Swift account.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_multiple_containers_seed</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">0</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>When set to 0, a single-tenant store will only use one container to store all
images. When set to an integer value between 1 and 32, a single-tenant store
will use multiple containers to store images, and this value will determine
how many characters from an image UUID are checked when determining what
container to place the image in. The maximum number of containers that will be
created is approximately equal to 16^N. This setting is used only when
swift_store_multi_tentant is disabled.</p>
<p>Example: if this config option is set to 3 and
swift_store_container = &#8216;glance&#8217;, then an image with UUID
&#8216;fdae39a1-bac5-4238-aba4-69bcc726e848&#8217; would be placed in the container
&#8216;glance_fda&#8217;. All dashes in the UUID are included when creating the container
name but do not count toward the character limit, so in this example with N=10
the container name would be &#8216;glance_fdae39a1-ba&#8217;.</p>
<p>When choosing the value for swift_store_multiple_containers_seed, deployers
should discuss a suitable value with their swift operations team. The authors
of this option recommend that large scale deployments use a value of &#8216;2&#8217;,
which will create a maximum of ~256 containers. Choosing a higher number than
this, even in extremely large scale deployments, may not have any positive
impact on performance and could lead to a large number of empty, unused
containers. The largest of deployments could notice an increase in performance
if swift rate limits are throttling on single container. Note: If dynamic
container creation is turned off, any value for this configuration option
higher than &#8216;1&#8217; may be unreasonable as the deployer would have to manually
create each container.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_admin_tenants</span></code></li>
</ul>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>Optional. Default: Not set.</p>
<p>A list of swift ACL strings that will be applied as both read and
write ACLs to the containers created by Glance in multi-tenant
mode. This grants the specified tenants/users read and write access
to all newly created image objects. The standard swift ACL string
formats are allowed, including:</p>
<p>&lt;tenant_id&gt;:&lt;username&gt;
&lt;tenant_name&gt;:&lt;username&gt;
*:&lt;username&gt;</p>
<p>Multiple ACLs can be combined using a comma separated list, for
example: swift_store_admin_tenants = <a class="reference external" href="service:glance,*:admin">service:glance,*:admin</a></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_auth_version</span></code></li>
</ul>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>Optional. Default: <code class="docutils literal"><span class="pre">2</span></code></p>
<p>A string indicating which version of Swift OpenStack authentication
to use. See the project
<a class="reference external" href="http://docs.openstack.org/developer/python-swiftclient/">python-swiftclient</a>
for more details.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_service_type</span></code></li>
</ul>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>Optional. Default: <code class="docutils literal"><span class="pre">object-store</span></code></p>
<p>A string giving the service type of the swift service to use. This
setting is only used if swift_store_auth_version is <code class="docutils literal"><span class="pre">2</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_region</span></code></li>
</ul>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>Optional. Default: Not set.</p>
<p>A string giving the region of the swift service endpoint to use. This
setting is only used if swift_store_auth_version is <code class="docutils literal"><span class="pre">2</span></code>. This
setting is especially useful for disambiguation if multiple swift
services might appear in a service catalog during authentication.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_endpoint_type</span></code></li>
</ul>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>Optional. Default: <code class="docutils literal"><span class="pre">publicURL</span></code></p>
<p>A string giving the endpoint type of the swift service endpoint to
use. This setting is only used if swift_store_auth_version is <code class="docutils literal"><span class="pre">2</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_ssl_compression</span></code></li>
</ul>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_cacert</span></code></li>
</ul>
<p>Can only be specified in configuration files.</p>
<p>Optional. Default: <code class="docutils literal"><span class="pre">None</span></code></p>
<p>A string giving the path to a CA certificate bundle that will allow Glance&#8217;s
services to perform SSL verification when communicating with Swift.</p>
<p>Optional. Default: True.</p>
<p>If set to False, disables SSL layer compression of https swift
requests. Setting to &#8216;False&#8217; may improve performance for images which
are already in a compressed format, e.g. qcow2. If set to True then
compression will be enabled (provided it is supported by the swift
proxy).</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_retry_get_count</span></code></li>
</ul>
<p>The number of times a Swift download will be retried before the request
fails.
Optional. Default: <code class="docutils literal"><span class="pre">0</span></code></p>
</div>
</div>
<div class="section" id="configuring-multiple-swift-accounts-stores">
<h2>Configuring Multiple Swift Accounts/Stores<a class="headerlink" href="#configuring-multiple-swift-accounts-stores" title="Permalink to this headline">¶</a></h2>
<p>In order to not store Swift account credentials in the database, and to
have support for multiple accounts (or multiple Swift backing stores), a
reference is stored in the database and the corresponding configuration
(credentials/ parameters) details are stored in the configuration file.
Optional.  Default: not enabled.</p>
<p>The location for this file is specified using the <code class="docutils literal"><span class="pre">swift_store_config_file</span></code> config file
in the section <code class="docutils literal"><span class="pre">[DEFAULT]</span></code>. <strong>If an incorrect value is specified, Glance API Swift store
service will not be configured.</strong>
* <code class="docutils literal"><span class="pre">swift_store_config_file=PATH</span></code></p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">default_swift_reference=DEFAULT_REFERENCE</span></code></li>
</ul>
<p>Required when multiple Swift accounts/backing stores are configured.</p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>It is the default swift reference that is used to add any new images.
* <code class="docutils literal"><span class="pre">swift_store_auth_insecure</span></code></p>
<p>If True, bypass SSL certificate verification for Swift.</p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Swift storage backend.</cite></p>
<p>Optional. Default: <code class="docutils literal"><span class="pre">False</span></code></p>
<div class="section" id="configuring-the-s3-storage-backend">
<h3>Configuring the S3 Storage Backend<a class="headerlink" href="#configuring-the-s3-storage-backend" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">s3_store_host=URL</span></code></li>
</ul>
<p>Required when using the S3 storage backend.</p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the S3 storage backend.</cite></p>
<p>Default: s3.amazonaws.com</p>
<p>Sets the main service URL supplied to S3 when making calls to its storage
system. For more information about the S3 authentication system, please
see the <a class="reference external" href="http://aws.amazon.com/documentation/s3/">S3 documentation</a></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">s3_store_access_key=ACCESS_KEY</span></code></li>
</ul>
<p>Required when using the S3 storage backend.</p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the S3 storage backend.</cite></p>
<p>Sets the access key to authenticate against the <code class="docutils literal"><span class="pre">s3_store_host</span></code> with.</p>
<p>You should set this to your 20-character Amazon AWS access key.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">s3_store_secret_key=SECRET_KEY</span></code></li>
</ul>
<p>Required when using the S3 storage backend.</p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the S3 storage backend.</cite></p>
<p>Sets the secret key to authenticate against the
<code class="docutils literal"><span class="pre">s3_store_host</span></code> with for the access key <code class="docutils literal"><span class="pre">s3_store_access_key</span></code>.</p>
<p>You should set this to your 40-character Amazon AWS secret key.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">s3_store_bucket=BUCKET</span></code></li>
</ul>
<p>Required when using the S3 storage backend.</p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the S3 storage backend.</cite></p>
<p>Sets the name of the bucket to use for Glance images in S3.</p>
<p>Note that the namespace for S3 buckets is <strong>global</strong>,
therefore you must use a name for the bucket that is unique. It
is recommended that you use a combination of your AWS access key,
<strong>lowercased</strong> with &#8220;glance&#8221;.</p>
<p>For instance if your Amazon AWS access key is:</p>
<p><code class="docutils literal"><span class="pre">ABCDEFGHIJKLMNOPQRST</span></code></p>
<p>then make your bucket value be:</p>
<p><code class="docutils literal"><span class="pre">abcdefghijklmnopqrstglance</span></code></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">s3_store_create_bucket_on_put</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">False</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the S3 storage backend.</cite></p>
<p>If true, Glance will attempt to create the bucket <code class="docutils literal"><span class="pre">s3_store_bucket</span></code>
if it does not exist.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">s3_store_object_buffer_dir=PATH</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">the</span> <span class="pre">platform's</span> <span class="pre">default</span> <span class="pre">temporary</span> <span class="pre">directory</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the S3 storage backend.</cite></p>
<p>When sending images to S3, what directory should be
used to buffer the chunks? By default the platform&#8217;s
temporary directory will be used.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">s3_store_large_object_size=SIZE_IN_MB</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">100</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the S3 storage backend.</cite></p>
<p>Size, in <code class="docutils literal"><span class="pre">MB</span></code>, should S3 start chunking image files
and do a multipart upload in S3.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">s3_store_large_object_chunk_size=SIZE_IN_MB</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">10</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the S3 storage backend.</cite></p>
<p>Multipart upload part size, in <code class="docutils literal"><span class="pre">MB</span></code>, should S3 use
when uploading parts. The size must be greater than or
equal to 5MB. The default is 10MB.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">s3_store_thread_pools=NUM</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">10</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the S3 storage backend.</cite></p>
<p>The number of thread pools to perform a multipart upload
in S3. The default is 10.</p>
</div>
<div class="section" id="configuring-the-rbd-storage-backend">
<h3>Configuring the RBD Storage Backend<a class="headerlink" href="#configuring-the-rbd-storage-backend" title="Permalink to this headline">¶</a></h3>
<p><strong>Note</strong>: the RBD storage backend requires the python bindings for
librados and librbd. These are in the python-ceph package on
Debian-based distributions.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">rbd_store_pool=POOL</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">rbd</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the RBD storage backend.</cite></p>
<p>Sets the RADOS pool in which images are stored.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">rbd_store_chunk_size=CHUNK_SIZE_MB</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">4</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the RBD storage backend.</cite></p>
<p>Images will be chunked into objects of this size (in megabytes).
For best performance, this should be a power of two.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">rbd_store_ceph_conf=PATH</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">/etc/ceph/ceph.conf</span></code>, <code class="docutils literal"><span class="pre">~/.ceph/config</span></code>, and <code class="docutils literal"><span class="pre">./ceph.conf</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the RBD storage backend.</cite></p>
<p>Sets the Ceph configuration file to use.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">rbd_store_user=NAME</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">admin</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the RBD storage backend.</cite></p>
<p>Sets the RADOS user to authenticate as. This is only needed
when <a class="reference external" href="http://ceph.newdream.net/wiki/Cephx">RADOS authentication</a>
is <a class="reference external" href="http://ceph.newdream.net/wiki/Cluster_configuration#Cephx_auth">enabled.</a></p>
<p>A keyring must be set for this user in the Ceph
configuration file, e.g. with a user <code class="docutils literal"><span class="pre">glance</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>[client.glance]
keyring=/etc/glance/rbd.keyring
</pre></div>
</div>
<p>To set up a user named <code class="docutils literal"><span class="pre">glance</span></code> with minimal permissions, using a pool called
<code class="docutils literal"><span class="pre">images</span></code>, run:</p>
<div class="highlight-python"><div class="highlight"><pre>rados mkpool images
ceph-authtool --create-keyring /etc/glance/rbd.keyring
ceph-authtool --gen-key --name client.glance --cap mon &#39;allow r&#39; --cap osd &#39;allow rwx pool=images&#39; /etc/glance/rbd.keyring
ceph auth add client.glance -i /etc/glance/rbd.keyring
</pre></div>
</div>
</div>
<div class="section" id="configuring-the-sheepdog-storage-backend">
<h3>Configuring the Sheepdog Storage Backend<a class="headerlink" href="#configuring-the-sheepdog-storage-backend" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">sheepdog_store_address=ADDR</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">localhost</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Sheepdog storage backend.</cite></p>
<p>Sets the IP address of the sheep daemon</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">sheepdog_store_port=PORT</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">7000</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Sheepdog storage backend.</cite></p>
<p>Sets the IP port of the sheep daemon</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">sheepdog_store_chunk_size=SIZE_IN_MB</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">64</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Sheepdog storage backend.</cite></p>
<p>Images will be chunked into objects of this size (in megabytes).
For best performance, this should be a power of two.</p>
</div>
<div class="section" id="configuring-the-cinder-storage-backend">
<h3>Configuring the Cinder Storage Backend<a class="headerlink" href="#configuring-the-cinder-storage-backend" title="Permalink to this headline">¶</a></h3>
<p><strong>Note</strong>: Currently Cinder store is a partial implementation.
After Cinder expose &#8216;brick&#8217; library, and &#8216;Readonly-volume-attaching&#8217;,
&#8216;volume-multiple-attaching&#8217; enhancement ready, the store will support
&#8216;Upload&#8217; and &#8216;Download&#8217; interface finally.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cinder_catalog_info=&lt;service_type&gt;:&lt;service_name&gt;:&lt;endpoint_type&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">volume:cinder:publicURL</span></code></p>
<p>Can only be specified in configuration files.</p>
<p><cite>This option is specific to the Cinder storage backend.</cite></p>
<p>Sets the info to match when looking for cinder in the service catalog.
Format is : separated values of the form: &lt;service_type&gt;:&lt;service_name&gt;:&lt;endpoint_type&gt;</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cinder_endpoint_template=http://ADDR:PORT/VERSION/%(project_id)s</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">None</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>Override service catalog lookup with template for cinder endpoint.
e.g. <a class="reference external" href="http://localhost:8776/v1/%(project_id)s">http://localhost:8776/v1/%(project_id)s</a></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">os_region_name=REGION_NAME</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">None</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>Region name of this node.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cinder_ca_certificates_file=CA_FILE_PATH</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">None</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>Location of ca certicates file to use for cinder client requests.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cinder_http_retries=TIMES</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">3</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>Number of cinderclient retries on failed http calls.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cinder_api_insecure=ON_OFF</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">False</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>Allow to perform insecure SSL requests to cinder.</p>
</div>
<div class="section" id="configuring-the-vmware-storage-backend">
<h3>Configuring the VMware Storage Backend<a class="headerlink" href="#configuring-the-vmware-storage-backend" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">vmware_server_host=ADDRESS</span></code></li>
</ul>
<p>Required when using the VMware storage backend.</p>
<p>Can only be specified in configuration files.</p>
<p>Sets the address of the ESX/ESXi or vCenter Server target system.
The address can contain an IP (<code class="docutils literal"><span class="pre">127.0.0.1</span></code>), an IP and port
(<code class="docutils literal"><span class="pre">127.0.0.1:443</span></code>), a DNS name (<code class="docutils literal"><span class="pre">www.my-domain.com</span></code>) or DNS and port.</p>
<p><cite>This option is specific to the VMware storage backend.</cite></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">vmware_server_username=USERNAME</span></code></li>
</ul>
<p>Required when using the VMware storage backend.</p>
<p>Can only be specified in configuration files.</p>
<p>Username for authenticating with VMware ESX/ESXi or vCenter Server.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">vmware_server_password=PASSWORD</span></code></li>
</ul>
<p>Required when using the VMware storage backend.</p>
<p>Can only be specified in configuration files.</p>
<p>Password for authenticating with VMware ESX/ESXi or vCenter Server.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">vmware_datacenter_path=DC_PATH</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">ha-datacenter</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>Inventory path to a datacenter. If the <code class="docutils literal"><span class="pre">vmware_server_host</span></code> specified
is an ESX/ESXi, the <code class="docutils literal"><span class="pre">vmware_datacenter_path</span></code> is optional. If specified,
it should be <code class="docutils literal"><span class="pre">ha-datacenter</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">vmware_datastore_name=DS_NAME</span></code></li>
</ul>
<p>Required when using the VMware storage backend.</p>
<p>Can only be specified in configuration files.</p>
<p>Datastore name associated with the <code class="docutils literal"><span class="pre">vmware_datacenter_path</span></code></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">vmware_datastores</span></code></li>
</ul>
<p>Optional. Default: Not set.</p>
<p>This option can only be specified in configuration file and is specific
to the VMware storage backend.</p>
<p>vmware_datastores allows administrators to configure multiple datastores to
save glance image in the VMware store backend. The required format for the
option is: &lt;datacenter_path&gt;:&lt;datastore_name&gt;:&lt;optional_weight&gt;.</p>
<p>where datacenter_path is the inventory path to the datacenter where the
datastore is located. An optional weight can be given to specify the priority.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre>vmware_datastores = datacenter1:datastore1
vmware_datastores = dc_folder/datacenter2:datastore2:100
vmware_datastores = datacenter1:datastore3:200
</pre></div>
</div>
<p><strong>NOTE</strong>:</p>
<blockquote>
<div><ul class="simple">
<li>This option can be specified multiple times to specify multiple datastores.</li>
<li>Either vmware_datastore_name or vmware_datastores option must be specified
in glance-api.conf</li>
<li>Datastore with weight 200 has precedence over datastore with weight 100.</li>
<li>If no weight is specified, default weight &#8216;0&#8217; is associated with it.</li>
<li>If two datastores have same weight, the datastore with maximum free space
will be chosen to store the image.</li>
<li>If the datacenter path or datastore name contains a colon (:) symbol, it
must be escaped with a backslash.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">vmware_api_retry_count=TIMES</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">10</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>The number of times VMware ESX/VC server API must be
retried upon connection related issues.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">vmware_task_poll_interval=SECONDS</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">5</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>The interval used for polling remote tasks invoked on VMware ESX/VC server.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">vmware_store_image_dir</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">/openstack_glance</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>The path to access the folder where the images will be stored in the datastore.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">vmware_api_insecure=ON_OFF</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">False</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>Allow to perform insecure SSL requests to ESX/VC server.</p>
</div>
<div class="section" id="configuring-the-storage-endpoint">
<h3>Configuring the Storage Endpoint<a class="headerlink" href="#configuring-the-storage-endpoint" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">swift_store_endpoint=URL</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">None</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>Overrides the storage URL returned by auth. The URL should include the
path up to and excluding the container. The location of an object is
obtained by appending the container and object to the configured URL.
e.g. <code class="docutils literal"><span class="pre">https://www.my-domain.com/v1/path_up_to_container</span></code></p>
</div>
</div>
<div class="section" id="configuring-the-image-cache">
<h2>Configuring the Image Cache<a class="headerlink" href="#configuring-the-image-cache" title="Permalink to this headline">¶</a></h2>
<p>Glance API servers can be configured to have a local image cache. Caching of
image files is transparent and happens using a piece of middleware that can
optionally be placed in the server application pipeline.</p>
<p>This pipeline is configured in the PasteDeploy configuration file,
&lt;component&gt;-paste.ini. You should not generally have to edit this file
directly, as it ships with ready-made pipelines for all common deployment
flavors.</p>
<div class="section" id="enabling-the-image-cache-middleware">
<h3>Enabling the Image Cache Middleware<a class="headerlink" href="#enabling-the-image-cache-middleware" title="Permalink to this headline">¶</a></h3>
<p>To enable the image cache middleware, the cache middleware must occur in
the application pipeline <strong>after</strong> the appropriate context middleware.</p>
<p>The cache middleware should be in your <code class="docutils literal"><span class="pre">glance-api-paste.ini</span></code> in a section
titled <code class="docutils literal"><span class="pre">[filter:cache]</span></code>. It should look like this:</p>
<div class="highlight-python"><div class="highlight"><pre>[filter:cache]
paste.filter_factory = glance.api.middleware.cache:CacheFilter.factory
</pre></div>
</div>
<p>A ready-made application pipeline including this filter is defined in
the <code class="docutils literal"><span class="pre">glance-api-paste.ini</span></code> file, looking like so:</p>
<div class="highlight-python"><div class="highlight"><pre>[pipeline:glance-api-caching]
pipeline = versionnegotiation context cache apiv1app
</pre></div>
</div>
<p>To enable the above application pipeline, in your main <code class="docutils literal"><span class="pre">glance-api.conf</span></code>
configuration file, select the appropriate deployment flavor like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">paste_deploy</span><span class="p">]</span>
<span class="n">flavor</span> <span class="o">=</span> <span class="n">caching</span>
</pre></div>
</div>
</div>
<div class="section" id="enabling-the-image-cache-management-middleware">
<h3>Enabling the Image Cache Management Middleware<a class="headerlink" href="#enabling-the-image-cache-management-middleware" title="Permalink to this headline">¶</a></h3>
<p>There is an optional <code class="docutils literal"><span class="pre">cachemanage</span></code> middleware that allows you to
directly interact with cache images. Use this flavor in place of the
<code class="docutils literal"><span class="pre">cache</span></code> flavor in your api config file.</p>
<blockquote>
<div>[paste_deploy]
flavor = cachemanage</div></blockquote>
</div>
<div class="section" id="configuration-options-affecting-the-image-cache">
<h3>Configuration Options Affecting the Image Cache<a class="headerlink" href="#configuration-options-affecting-the-image-cache" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These configuration options must be set in both the glance-cache
and glance-api configuration files.</p>
</div>
<p>One main configuration file option affects the image cache.</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">image_cache_dir=PATH</span></code></li>
</ul>
</div></blockquote>
<p>Required when image cache middleware is enabled.</p>
<p>Default: <code class="docutils literal"><span class="pre">/var/lib/glance/image-cache</span></code></p>
<p>This is the base directory the image cache can write files to.
Make sure the directory is writeable by the user running the
<code class="docutils literal"><span class="pre">glance-api</span></code> server</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">image_cache_driver=DRIVER</span></code></li>
</ul>
</div></blockquote>
<p>Optional. Choice of <code class="docutils literal"><span class="pre">sqlite</span></code> or <code class="docutils literal"><span class="pre">xattr</span></code></p>
<p>Default: <code class="docutils literal"><span class="pre">sqlite</span></code></p>
<p>The default <code class="docutils literal"><span class="pre">sqlite</span></code> cache driver has no special dependencies, other
than the <code class="docutils literal"><span class="pre">python-sqlite3</span></code> library, which is installed on virtually
all operating systems with modern versions of Python. It stores
information about the cached files in a SQLite database.</p>
<p>The <code class="docutils literal"><span class="pre">xattr</span></code> cache driver required the <code class="docutils literal"><span class="pre">python-xattr&gt;=0.6.0</span></code> library
and requires that the filesystem containing <code class="docutils literal"><span class="pre">image_cache_dir</span></code> have
access times tracked for all files (in other words, the noatime option
CANNOT be set for that filesystem). In addition, <code class="docutils literal"><span class="pre">user_xattr</span></code> must be
set on the filesystem&#8217;s description line in fstab. Because of these
requirements, the <code class="docutils literal"><span class="pre">xattr</span></code> cache driver is not available on Windows.</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">image_cache_sqlite_db=DB_FILE</span></code></li>
</ul>
</div></blockquote>
<p>Optional.</p>
<p>Default: <code class="docutils literal"><span class="pre">cache.db</span></code></p>
<p>When using the <code class="docutils literal"><span class="pre">sqlite</span></code> cache driver, you can set the name of the database
that will be used to store the cached images information. The database
is always contained in the <code class="docutils literal"><span class="pre">image_cache_dir</span></code>.</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">image_cache_max_size=SIZE</span></code></li>
</ul>
</div></blockquote>
<p>Optional.</p>
<p>Default: <code class="docutils literal"><span class="pre">10737418240</span></code> (10 GB)</p>
<p>Size, in bytes, that the image cache should be constrained to. Images files
are cached automatically in the local image cache, even if the writing of that
image file would put the total cache size over this size. The
<code class="docutils literal"><span class="pre">glance-cache-pruner</span></code> executable is what prunes the image cache to be equal
to or less than this value. The <code class="docutils literal"><span class="pre">glance-cache-pruner</span></code> executable is designed
to be run via cron on a regular basis. See more about this executable in
<a class="reference internal" href="cache.html"><em>Controlling the Growth of the Image Cache</em></a></p>
</div>
</div>
<div class="section" id="configuring-the-glance-registry">
<h2>Configuring the Glance Registry<a class="headerlink" href="#configuring-the-glance-registry" title="Permalink to this headline">¶</a></h2>
<p>There are a number of configuration options in Glance that control how
this registry server operates. These configuration options are specified in the
<code class="docutils literal"><span class="pre">glance-registry.conf</span></code> config file in the section <code class="docutils literal"><span class="pre">[DEFAULT]</span></code>.</p>
<p><strong>IMPORTANT NOTE</strong>: The glance-registry service is only used in conjunction
with the glance-api service when clients are using the v1 REST API. See
<a class="reference internal" href="#configuring-glance-apis">Configuring Glance APIs</a> for more info.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">sql_connection=CONNECTION_STRING</span></code> (<code class="docutils literal"><span class="pre">--sql-connection</span></code> when specified
on command line)</li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">None</span></code></p>
<p>Can be specified in configuration files. Can also be specified on the
command-line for the <code class="docutils literal"><span class="pre">glance-manage</span></code> program.</p>
<p>Sets the SQLAlchemy connection string to use when connecting to the registry
database. Please see the documentation for
<a class="reference external" href="http://www.sqlalchemy.org/docs/05/reference/sqlalchemy/connections.html">SQLAlchemy connection strings</a>
online. You must urlencode any special characters in CONNECTION_STRING.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">sql_timeout=SECONDS</span></code>
on command line)</li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">3600</span></code></p>
<p>Can only be specified in configuration files.</p>
<p>Sets the number of seconds after which SQLAlchemy should reconnect to the
datastore if no activity has been made on the connection.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">enable_v1_registry=&lt;True|False&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">True</span></code></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">enable_v2_registry=&lt;True|False&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">True</span></code></p>
<p>Defines which version(s) of the Registry API will be enabled.
If the Glance API server parameter <code class="docutils literal"><span class="pre">enable_v1_api</span></code> has been set to <code class="docutils literal"><span class="pre">True</span></code> the
<code class="docutils literal"><span class="pre">enable_v1_registry</span></code> has to be <code class="docutils literal"><span class="pre">True</span></code> as well.
If the Glance API server parameter <code class="docutils literal"><span class="pre">enable_v2_api</span></code> has been set to <code class="docutils literal"><span class="pre">True</span></code> and
the parameter <code class="docutils literal"><span class="pre">data_api</span></code> has been set to <code class="docutils literal"><span class="pre">glance.db.registry.api</span></code> the
<code class="docutils literal"><span class="pre">enable_v2_registry</span></code> has to be set to <code class="docutils literal"><span class="pre">True</span></code></p>
</div>
<div class="section" id="configuring-notifications">
<h2>Configuring Notifications<a class="headerlink" href="#configuring-notifications" title="Permalink to this headline">¶</a></h2>
<p>Glance can optionally generate notifications to be logged or sent to
a message queue. The configuration options are specified in the
<code class="docutils literal"><span class="pre">glance-api.conf</span></code> config file in the section <code class="docutils literal"><span class="pre">[DEFAULT]</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">notification_driver</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">noop</span></code></p>
<p>Sets the notification driver used by oslo.messaging. Options include
<code class="docutils literal"><span class="pre">messaging</span></code>, <code class="docutils literal"><span class="pre">messagingv2</span></code>, <code class="docutils literal"><span class="pre">log</span></code> and <code class="docutils literal"><span class="pre">routing</span></code>.</p>
<p>For more information see <a class="reference internal" href="notifications.html"><em>Glance notifications</em></a> and
<a class="reference external" href="http://docs.openstack.org/developer/oslo.messaging/">oslo.messaging</a>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">disabled_notifications</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">[]</span></code></p>
<p>List of disabled notifications. A notification can be given either as a
notification type to disable a single event, or as a notification group prefix
to disable all events within a group.</p>
<p>Example: if this config option is set to [&#8220;image.create&#8221;, &#8220;metadef_namespace&#8221;],
then &#8220;image.create&#8221; notification will not be sent after image is created and
none of the notifications for metadefinition namespaces will be sent.</p>
</div>
<div class="section" id="configuring-glance-property-protections">
<h2>Configuring Glance Property Protections<a class="headerlink" href="#configuring-glance-property-protections" title="Permalink to this headline">¶</a></h2>
<p>Access to image meta properties may be configured using a
<a class="reference internal" href="property-protections.html"><em>Property Protections Configuration file</em></a>.  The
location for this file can be specified in the <code class="docutils literal"><span class="pre">glance-api.conf</span></code> config file
in the section <code class="docutils literal"><span class="pre">[DEFAULT]</span></code>. <strong>If an incorrect value is specified, glance api
service will not start.</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">property_protection_file=PATH</span></code></li>
</ul>
<p>Optional. Default: not enabled.</p>
<p>If property_protection_file is set, the file may use either roles or policies
to specify property protections.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">property_protection_rule_format=&lt;roles|policies&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">roles</span></code>.</p>
</div>
<div class="section" id="configuring-glance-apis">
<h2>Configuring Glance APIs<a class="headerlink" href="#configuring-glance-apis" title="Permalink to this headline">¶</a></h2>
<p>The glance-api service implements versions 1 and 2 of the OpenStack
Images API. Disable either version of the Images API using the
following options:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">enable_v1_api=&lt;True|False&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">True</span></code></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">enable_v2_api=&lt;True|False&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">True</span></code></p>
<p><strong>IMPORTANT NOTE</strong>: The v1 API is implemented on top of the
glance-registry service while the v2 API is not. This means that
in order to use the v2 API, you must copy the necessary sql
configuration from your glance-registry service to your
glance-api configuration file.</p>
</div>
<div class="section" id="configuring-glance-tasks">
<h2>Configuring Glance Tasks<a class="headerlink" href="#configuring-glance-tasks" title="Permalink to this headline">¶</a></h2>
<p>Glance Tasks are implemented only for version 2 of the OpenStack Images API.</p>
<p>The config value <code class="docutils literal"><span class="pre">task_time_to_live</span></code> is used to determine how long a task
would be visible to the user after transitioning to either the <code class="docutils literal"><span class="pre">success</span></code> or
the <code class="docutils literal"><span class="pre">failure</span></code> state.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">task_time_to_live=&lt;Time_in_hours&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">48</span></code></p>
<p>The config value <code class="docutils literal"><span class="pre">task_executor</span></code> is used to determine which executor
should be used by the Glance service to process the task. The currently
available implementation is: <code class="docutils literal"><span class="pre">taskflow</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">task_executor=&lt;executor_type&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">taskflow</span></code></p>
<p>The <code class="docutils literal"><span class="pre">taskflow</span></code> engine has its own set of configuration options,
under the <code class="docutils literal"><span class="pre">taskflow_executor</span></code> section, that can be tuned to improve
the task execution process. Among the available options, you may find
<code class="docutils literal"><span class="pre">engine_mode</span></code> and <code class="docutils literal"><span class="pre">max_workers</span></code>. The former allows for selecting
an execution model and the available options are <code class="docutils literal"><span class="pre">serial</span></code>,
<code class="docutils literal"><span class="pre">parallel</span></code> and <code class="docutils literal"><span class="pre">worker-based</span></code>. The <code class="docutils literal"><span class="pre">max_workers</span></code> option,
instead, allows for controlling the number of workers that will be
instantiated per executor instance.</p>
<p>The default value for the <code class="docutils literal"><span class="pre">engine_mode</span></code> is <code class="docutils literal"><span class="pre">parallel</span></code>, whereas
the default number of <code class="docutils literal"><span class="pre">max_workers</span></code> is <code class="docutils literal"><span class="pre">10</span></code>.</p>
</div>
<div class="section" id="configuring-glance-performance-profiling">
<h2>Configuring Glance performance profiling<a class="headerlink" href="#configuring-glance-performance-profiling" title="Permalink to this headline">¶</a></h2>
<p>Glance supports using osprofiler to trace the performance of each key internal
handling, including RESTful API calling, DB operation and etc.</p>
<p><code class="docutils literal"><span class="pre">Please</span> <span class="pre">be</span> <span class="pre">aware</span> <span class="pre">that</span> <span class="pre">Glance</span> <span class="pre">performance</span> <span class="pre">profiling</span> <span class="pre">is</span> <span class="pre">currently</span> <span class="pre">a</span> <span class="pre">work</span> <span class="pre">in</span>
<span class="pre">progress</span> <span class="pre">feature.</span></code> Although, some trace points is available, e.g. API
execution profiling at wsgi main entry and SQL execution profiling at DB
module, the more fine-grained trace point is being worked on.</p>
<p>The config value <code class="docutils literal"><span class="pre">enabled</span></code> is used to determine whether fully enable
profiling feature for glance-api and glance-registry service.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">enabled=&lt;True|False&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">True</span></code></p>
<p>The config value <code class="docutils literal"><span class="pre">trace_sqlalchemy</span></code> is used to determine whether fully enable
sqlalchemy engine based SQL execution profiling feature for glance-api and
glance-registry services.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">trace_sqlalchemy=&lt;True|False&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">True</span></code></p>
<p><strong>IMPORTANT NOTE</strong>: The HMAC key which is used for encrypting context data for
performance profiling is configured in paste config file of glance-api and
glance-registry service separately, by default they place at
/etc/glance/api-paste.ini and /etc/glance/registry-paste.ini files, in order
to make profiling work as designed operator needs to make those values of HMAC
key be consistent for all services in your deployment. Without HMAC key the
profiling will not be triggered even profiling feature is enabled.</p>
</div>
<div class="section" id="configuring-glance-public-endpoint">
<h2>Configuring Glance public endpoint<a class="headerlink" href="#configuring-glance-public-endpoint" title="Permalink to this headline">¶</a></h2>
<p>This setting allows an operator to configure the endpoint URL that will
appear in the Glance &#8220;versions&#8221; response (that is, the response to
<code class="docutils literal"><span class="pre">GET</span> <span class="pre">/</span></code> ).  This can be necessary when the Glance API service is run
behind a proxy because the default endpoint displayed in the versions
response is that of the host actually running the API service.  If
Glance is being run behind a load balancer, for example, direct access
to individual hosts running the Glance API may not be allowed, hence the
load balancer URL would be used for this value.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">public_endpoint=&lt;None|URL&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">None</span></code></p>
</div>
<div class="section" id="configuring-glance-digest-algorithm">
<h2>Configuring Glance digest algorithm<a class="headerlink" href="#configuring-glance-digest-algorithm" title="Permalink to this headline">¶</a></h2>
<p>Digest algorithm which will be used for digital signature; the default is
sha1 for a smooth upgrade process but the recommended value is sha256. Use the
command:</p>
<div class="highlight-python"><div class="highlight"><pre>openssl list-message-digest-algorithms
</pre></div>
</div>
<p>to get the available algorithms supported by the version of OpenSSL on the
platform. Examples are &#8220;sha1&#8221;, &#8220;sha256&#8221;, &#8220;sha512&#8221;, etc. If an invalid
digest algorithm is configured, all digital signature operations will fail and
return a ValueError exception with &#8220;No such digest method&#8221; error.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">digest_algorithm=&lt;algorithm&gt;</span></code></li>
</ul>
<p>Optional. Default: <code class="docutils literal"><span class="pre">sha1</span></code></p>
</div>
<div class="section" id="configuring-http-keepalive-option">
<h2>Configuring http_keepalive option<a class="headerlink" href="#configuring-http-keepalive-option" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">http_keepalive=&lt;True|False&gt;</span></code></li>
</ul>
<p>If False, server will return the header &#8220;Connection: close&#8221;, If True, server
will return &#8220;Connection: Keep-Alive&#8221; in its responses. In order to close the
client socket connection explicitly after the response is sent and read
successfully by the client, you simply have to set this option to False when
you create a wsgi server.</p>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Basic Configuration</a><ul>
<li><a class="reference internal" href="#common-configuration-options-in-glance">Common Configuration Options in Glance</a></li>
<li><a class="reference internal" href="#configuring-server-startup-options">Configuring Server Startup Options</a><ul>
<li><a class="reference internal" href="#configuring-ssl-support">Configuring SSL Support</a></li>
<li><a class="reference internal" href="#configuring-registry-access">Configuring Registry Access</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-logging-in-glance">Configuring Logging in Glance</a><ul>
<li><a class="reference internal" href="#logging-options-available-only-in-configuration-files">Logging Options Available Only in Configuration Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-glance-storage-backends">Configuring Glance Storage Backends</a></li>
<li><a class="reference internal" href="#configuring-glance-image-size-limit">Configuring Glance Image Size Limit</a></li>
<li><a class="reference internal" href="#configuring-glance-user-storage-quota">Configuring Glance User Storage Quota</a><ul>
<li><a class="reference internal" href="#configuring-the-filesystem-storage-backend">Configuring the Filesystem Storage Backend</a></li>
<li><a class="reference internal" href="#configuring-the-filesystem-storage-backend-with-multiple-stores">Configuring the Filesystem Storage Backend with multiple stores</a></li>
<li><a class="reference internal" href="#configuring-the-swift-storage-backend">Configuring the Swift Storage Backend</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-multiple-swift-accounts-stores">Configuring Multiple Swift Accounts/Stores</a><ul>
<li><a class="reference internal" href="#configuring-the-s3-storage-backend">Configuring the S3 Storage Backend</a></li>
<li><a class="reference internal" href="#configuring-the-rbd-storage-backend">Configuring the RBD Storage Backend</a></li>
<li><a class="reference internal" href="#configuring-the-sheepdog-storage-backend">Configuring the Sheepdog Storage Backend</a></li>
<li><a class="reference internal" href="#configuring-the-cinder-storage-backend">Configuring the Cinder Storage Backend</a></li>
<li><a class="reference internal" href="#configuring-the-vmware-storage-backend">Configuring the VMware Storage Backend</a></li>
<li><a class="reference internal" href="#configuring-the-storage-endpoint">Configuring the Storage Endpoint</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-the-image-cache">Configuring the Image Cache</a><ul>
<li><a class="reference internal" href="#enabling-the-image-cache-middleware">Enabling the Image Cache Middleware</a></li>
<li><a class="reference internal" href="#enabling-the-image-cache-management-middleware">Enabling the Image Cache Management Middleware</a></li>
<li><a class="reference internal" href="#configuration-options-affecting-the-image-cache">Configuration Options Affecting the Image Cache</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-the-glance-registry">Configuring the Glance Registry</a></li>
<li><a class="reference internal" href="#configuring-notifications">Configuring Notifications</a></li>
<li><a class="reference internal" href="#configuring-glance-property-protections">Configuring Glance Property Protections</a></li>
<li><a class="reference internal" href="#configuring-glance-apis">Configuring Glance APIs</a></li>
<li><a class="reference internal" href="#configuring-glance-tasks">Configuring Glance Tasks</a></li>
<li><a class="reference internal" href="#configuring-glance-performance-profiling">Configuring Glance performance profiling</a></li>
<li><a class="reference internal" href="#configuring-glance-public-endpoint">Configuring Glance public endpoint</a></li>
<li><a class="reference internal" href="#configuring-glance-digest-algorithm">Configuring Glance digest algorithm</a></li>
<li><a class="reference internal" href="#configuring-http-keepalive-option">Configuring http_keepalive option</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="installing.html"
                                  title="previous chapter">Installation</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="authentication.html"
                                  title="next chapter">Authentication With Keystone</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/configuring.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="authentication.html" title="Authentication With Keystone"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="installing.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Glance 2015.1.1.dev9 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2010-2014, OpenStack Foundation..
      Last updated on Sat May 2 03:07:23 2015, commit bcc7721.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>